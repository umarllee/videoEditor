"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDatabase = void 0;
const geoip2_node_1 = require("@maxmind/geoip2-node");
const file_utils_1 = require("../../file-utils");
let cityReader;
let asnReader;
/**
 * Get the DB connection to use for a CRUD operation.
 * If it doesn't exist then create it.
 */
exports.getDatabase = async () => {
    if (!cityReader) {
        const options = {};
        const cityDbFilePath = await file_utils_1.getCityDbFilePath();
        cityReader = await geoip2_node_1.Reader.open(cityDbFilePath, options);
    }
    if (!asnReader) {
        const options = {};
        const asnDbFilePath = await file_utils_1.getAsnDbFilePath();
        asnReader = await geoip2_node_1.Reader.open(asnDbFilePath, options);
    }
    return {
        asnReader,
        cityReader,
    };
};
//# sourceMappingURL=db-helper.js.map